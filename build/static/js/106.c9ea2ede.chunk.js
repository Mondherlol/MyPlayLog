"use strict";(self.webpackChunkmyplaylog_frontend_web=self.webpackChunkmyplaylog_frontend_web||[]).push([[106],{6106:function(e,t,n){n.r(t),n.d(t,{default:function(){return te}});var r=n(5987),o=n(1413),i=n(9439),s=n(168),a=n(2791),l=n(2360),c=n(7689),d=n(1087),u=n(1912),f=n(3433),h=n(5),p=n(2835),g=(n(763),n(5443)),x=n(7192),m=n(9085),v=n(9230),Z=n(184);function b(e){var t=e.listId,n=e.list,r=e.setList,s=(0,a.useState)([]),l=(0,i.Z)(s,2),c=l[0],d=l[1],b=(0,a.useState)([]),j=(0,i.Z)(b,2),y=j[0],w=j[1],_=(0,a.useState)({}),k=(0,i.Z)(_,2),T=k[0],I=k[1],P=(0,a.useState)(0),S=(0,i.Z)(P,2),C=S[0],O=S[1],N=(0,a.useState)(""),B=(0,i.Z)(N,2),A=B[0],D=B[1],F=(0,v.$G)().t;(0,a.useEffect)((function(){if(T&&T!=={}&&T.id){if(n.games.some((function(e){return e.id_IGDB===T.id})))m.Am.info(F("game_already_in_list"),{position:m.Am.POSITION.BOTTOM_RIGHT,theme:"dark",autoClose:3e3});else{O(50);var e={id_IGDB:T.id},i=t;if(void 0!==i){var s={method:"post",url:"".concat("http://141-95-162-17.nip.io:8000","/api/lists/game?ids=").concat(i),withCredentials:!0,headers:{"Content-Type":"application/json"},data:(0,o.Z)({},e)};(0,u.Z)(s).then((function(e){O(80),r((function(e){var t=(0,o.Z)({},T);return t.id_IGDB=t.id,-1===e.games.findIndex((function(e){return e.id===t.id}))?(0,o.Z)((0,o.Z)({},e),{},{games:[t].concat((0,f.Z)(e.games))}):e}))})).catch((function(e){console.log(e),m.Am.error(e.message,{position:m.Am.POSITION.BOTTOM_RIGHT,theme:"dark"})})).finally((function(){return O(100)}))}}I({})}}),[T]);return(0,a.useEffect)((function(){y&&d(y.map((function(e){return{value:e.slug,label:(0,Z.jsx)("div",{style:{display:"flex",justifyContent:"space-between"},children:(0,Z.jsxs)("div",{className:"flex flex-row justify-start items-start gap-2",children:[(0,Z.jsx)("img",{src:"https://images.igdb.com/igdb/image/upload/t_cover_small/".concat(e.cover?e.cover.image_id:"undefined",".jpg"),alt:"zelda",width:50,height:65}),(0,Z.jsxs)("div",{className:" flex flex-col flex-wrap",children:[(0,Z.jsx)("h4",{className:" overflow-hidden text-ellipsis ",children:e.name}),e.first_release_date&&(0,Z.jsx)("p",{children:new Date(1e3*e.first_release_date).getFullYear()}),(0,Z.jsx)("p",{className:" text-gray-500  text-xs",children:e.platforms&&e.platforms.map((function(e){return e.abbreviation?e.abbreviation:e.name})).join(", ")})]})]})})}})))}),[y]),(0,a.useEffect)((function(){var e=setTimeout((function(){var e;console.log(A),A.length>2&&(e=A)&&""!==e&&(O(10),u.Z.get("".concat("http://141-95-162-17.nip.io:8000","/api/games/search/light/").concat(e)).then((function(e){return w(e.data)})).catch((function(e){return console.log(e)})).finally((function(){return O(100)})))}),500);return function(){return clearTimeout(e)}}),[A]),(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(g.Z,{color:x.Z.primary,progress:C,onLoaderFinished:function(){return O(0)}}),(0,Z.jsx)(h.Z,{dropdownMatchSelectWidth:252,style:{width:300},value:A,options:c,onSelect:function(e){var t=y.find((function(t){return t.slug===e}));I(t),D("")},notFoundContent:"Pas de r\xe9sultat !",children:(0,Z.jsx)(p.Z.Search,{size:"large",placeholder:F("search_any_game"),onChange:function(e){D(e.target.value)}})})]})}var j,y,w,_,k=n(8848),T=n(4422),I=n(1793),P=n(4824),S=n(5216),C=n(3893),O=n(8218),N=n(5820),B=l.ZP.button(j||(j=(0,s.Z)(["\n  border: none;\n  position: absolute;\n  bottom: 50px;\n  right: 2px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  position: absolute;\n  color: ",";\n  font-size: 2.2vh;\n  background-color: rgb(255, 255, 255);\n\n  padding: 5px 10px 5px 10px;\n  cursor: pointer;\n  &:hover {\n    background-color: ",";\n    color: white;\n  }\n"])),x.Z.danger,x.Z.danger),A=function(e){var t=e.gameId,n=e.setList,r=e.list,i=e.setProgress,s=(0,v.$G)().t;return(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(N.Z,{placement:"bottom",title:"".concat(s("remove_this_game"),"?"),onConfirm:function(){i(20),u.Z.delete("".concat("http://141-95-162-17.nip.io:8000","/api/lists/").concat(r._id,"/").concat(t),{withCredentials:!0}).then((function(e){var i=r.games.findIndex((function(e){return e.id===t})),s=[].concat((0,f.Z)(r.games.slice(0,i)),(0,f.Z)(r.games.slice(i+1)));n((function(e){return(0,o.Z)((0,o.Z)({},e),{},{games:s})}))})).catch((function(e){console.log(e),m.Am.error(e.message,{position:m.Am.POSITION.BOTTOM_RIGHT,theme:"dark"})})).finally((function(){return i(100)}))},okText:s("yes"),okButtonProps:{style:{backgroundColor:x.Z.danger}},cancelText:s("no"),children:(0,Z.jsx)(B,{children:(0,Z.jsx)("h5",{children:s("delete").toUpperCase()})})})})},D="https://images.igdb.com/igdb/image/upload/t_cover_big/nocover.png",F=l.ZP.figure(y||(y=(0,s.Z)(["\n  margin: 7px;\n  width: calc(180px - 2vw);\n  @media (max-width: 768px) {\n    width: calc(180px - 10vw);\n  }\n  cursor:grab;\n\n  overflow: hidden;\n  position:relative;\n  box-shadow: 0 5px 10px rgb(0 0 0 / 80%);\n  transform-origin: center top;\n  transform-style: preserve-3d;\n  transform: translateZ(0);\n  transition: 0.3s;\n  &:hover {\n    box-shadow 0 8px 16px 3px rgba( #000, .6 );\n    transform translateY( -3px ) scale( 1.05 );\n\n  }\n  & > img{\n    width:100%;\n    min-height:100%;\n  }\n  &:hover > figcaption{\n    transform:translateY(0px);\n  }\n"]))),G=l.ZP.figcaption(w||(w=(0,s.Z)(["\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  color: white;\n  transition:0.28s;\n  text-shadow: 1px 1px 2px black;\n  padding-bottom 10px;\n\n  margin-left:5px;\n  \n  transform:translateY(200px);\n"]))),z=l.ZP.div(_||(_=(0,s.Z)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  position: absolute;\n  color: white;\n  font-size: 3vh;\n  width: 35px;\n  border: 2px solid white;\n  height: 35px;\n  top: 3px;\n  left: 3px;\n  background-color: rgb(8, 7, 27, 0.7);\n  border-radius: 12px;\n"])));function L(e){var t=(0,C.nB)({id:e.id}),n=t.attributes,r=t.listeners,i=t.setNodeRef,s=t.transform,a=t.transition;var l={transform:O.ux.Transform.toString(s),transition:a};return(0,Z.jsxs)("div",(0,o.Z)((0,o.Z)((0,o.Z)({className:"relative",ref:i,style:l},n),r),{},{children:[(0,Z.jsxs)(F,{children:[(0,Z.jsx)("img",{src:e.game.cover?"https://images.igdb.com/igdb/image/upload/t_cover_big/".concat(e.game.cover.image_id,".jpg"):D,alt:e.game.slug}),(0,Z.jsx)(G,{children:e.game.name}),e.list.ranked&&(0,Z.jsx)(z,{children:(0,Z.jsx)("h1",{children:e.index+1})})]}),(0,Z.jsx)(A,{setList:e.setList,list:e.list,gameId:e.game.id,setProgress:e.setProgress})]}))}function H(e){var t=e.list,n=e.setList,r=e.setProgress,s=(0,S.Dy)((0,S.VT)(S.MA,{activationConstraint:{distance:8}}),(0,S.VT)(S.LO,{activationConstraint:{delay:250,tolerance:5}}));return(0,Z.jsx)(S.LB,{autoScroll:!0,sensors:s,collisionDetection:S.pE,onDragEnd:function(e){var r=e.active,s=e.over;if(r.id!==s.id){var a=t.games.findIndex((function(e){return e.id===r.id})),l=t.games.findIndex((function(e){return e.id===s.id}));n((function(e){var t=(0,f.Z)(e.games),n=t.splice(a,1),r=(0,i.Z)(n,1)[0];t.splice(l,0,r);var s=t.map((function(e,t){return(0,o.Z)((0,o.Z)({},e),{},{rank:t+1})}));return(0,o.Z)((0,o.Z)({},e),{},{games:s})}))}},children:(0,Z.jsx)("div",{className:"flex flex-row",children:(0,Z.jsx)("div",{className:"flex flex-col flex-1",children:(0,Z.jsx)(C.Fo,{items:t.games,children:(0,Z.jsx)("div",{className:"flex flex-row flex-wrap",children:t.games.map((function(e,o){return(0,Z.jsx)(L,{list:t,setList:n,id:e.id,game:e,index:o,setProgress:r},e.id)}))})})})})})}var R=n(9286),E=n(5303),M=n(2339),W=n(1431),U=n(8825);var V,Y,$=function(e){var t=e.tags,n=e.setTags,r=(0,a.useState)(!1),o=(0,i.Z)(r,2),s=o[0],l=o[1],c=(0,a.useState)(""),d=(0,i.Z)(c,2),u=d[0],h=d[1],g=(0,a.useState)(-1),m=(0,i.Z)(g,2),v=m[0],b=m[1],j=(0,a.useState)(""),y=(0,i.Z)(j,2),w=y[0],_=y[1],T=(0,a.useRef)(null),I=(0,a.useRef)(null);(0,a.useEffect)((function(){var e;s&&(null===(e=T.current)||void 0===e||e.focus())}),[s]),(0,a.useEffect)((function(){var e;null===(e=I.current)||void 0===e||e.focus()}),[u]);var P=function(){u&&!t.some((function(e){return e.tag===u}))&&n([].concat((0,f.Z)(t),[{tag:u}])),l(!1),h("")},S=function(e){_(e.target.value)},C=function(){var e=(0,f.Z)(t);e[v].tag=w,n(e),b(-1),h("")},O={width:78,verticalAlign:"top"},N={background:x.Z.backgroundDerivation,borderStyle:"dashed",color:x.Z.primary};return(0,Z.jsx)(k.ZP,{theme:{token:{colorBorder:"white",fontSize:18,colorInfoBorderHover:"white",colorPrimaryBorderHover:"white",colorPrimaryHover:"white",fontFamily:"Inter"}},children:(0,Z.jsxs)(E.Z,{size:[0,8],wrap:!0,children:[(0,Z.jsx)(E.Z,{size:[0,8],wrap:!0,children:t.map((function(e,r){if(v===r)return(0,Z.jsx)(p.Z,{ref:I,size:"small",style:O,value:w,onChange:S,onBlur:C,onPressEnter:C},e.tag);var o=e.tag.length>20,i=(0,Z.jsx)(M.Z,{closable:!0,style:{fontSize:18,fontFamily:"Inter",userSelect:"none",color:x.Z.backgroundDerivation},color:"white",closeIcon:(0,Z.jsx)("span",{className:"  font-extrabold",children:"\u2715"}),onClose:function(){return function(e){var r=t.filter((function(t){return t.tag!==e.tag}));console.log(r),n(r)}(e)},children:(0,Z.jsx)("span",{onDoubleClick:function(t){0!==r&&(b(r),_(e.tag),t.preventDefault())},children:o?"".concat(e.tag.slice(0,20),"..."):e.tag})},e.tag);return o?(0,Z.jsx)(W.Z,{title:e,children:i},e):i}))}),s?(0,Z.jsx)(p.Z,{ref:T,type:"text",size:"small",style:O,value:u,onChange:function(e){h(e.target.value)},onBlur:P,onPressEnter:P,maxLength:20}):(0,Z.jsxs)(M.Z,{style:N,onClick:function(){l(!0)},children:[(0,Z.jsx)(R.Z,{})," ",(0,U.t)("new_tag")]})]})})},q=n(2482),J=n(4882),K=["rank"],Q=p.Z.TextArea,X=l.ZP.div(V||(V=(0,s.Z)(["\n  min-height: 100vh;\n  padding: 20px;\n  padding-top: 80px;\n  overflow: hidden;\n"]))),ee=l.ZP.input(Y||(Y=(0,s.Z)(["\n  width: 100%;\n  padding: 10px 20px;\n  // padding-left:10px;\n  border-color: transparent;\n  border-bottom: 1px solid darkgrey;\n  font-size: 1.875rem;\n  line-height: 2.25rem;\n  font-weight: bold;\n  background: transparent;\n  color: white;\n  &:focus {\n    outline: none;\n  }\n  &::-webkit-input-placeholder {\n    padding-left: 5px;\n    font-size: 15px;\n    color: rgb(255,255,255,0.8)\n  }\n  &::-moz-placeholder {\n    /* Firefox 19+ */\n    padding-left: 5px;\n    font-size: 15px;\n    color: rgb(255,255,255,0.8)\n  }\n  &:-ms-input-placeholder {\n    padding-left: 5px;\n    font-size: 15px;\n    color: rgb(255,255,255,0.8)\n      );\n  }\n  \n"])));function te(){var e=(0,v.$G)().t,t=(0,c.UO)().listId,n=(0,a.useState)(null),s=(0,i.Z)(n,2),l=s[0],f=s[1],h=(0,a.useState)(!0),p=(0,i.Z)(h,2),j=p[0],y=p[1],w=(0,a.useState)(null),_=(0,i.Z)(w,2),S=_[0],C=_[1],O=(0,a.useState)(0),N=(0,i.Z)(O,2),B=N[0],A=N[1],D=(0,a.useContext)(I.V).loginData,F=(0,a.useState)(""),G=(0,i.Z)(F,2),z=G[0],L=G[1],R=(0,a.useState)(!0),E=(0,i.Z)(R,2),M=E[0],W=E[1],U=(0,a.useState)(!1),V=(0,i.Z)(U,2),Y=V[0],te=V[1],ne=(0,a.useState)(""),re=(0,i.Z)(ne,2),oe=re[0],ie=re[1],se=(0,a.useState)([]),ae=(0,i.Z)(se,2),le=ae[0],ce=ae[1],de=(0,c.s0)();(0,a.useEffect)((function(){A(20),u.Z.get("".concat("http://141-95-162-17.nip.io:8000","/api/lists/").concat(t)).then((function(e){f(e.data),(!D||D&&D._id!==e.data.idOwner)&&de("/login"),y(!1),L(e.data.name),ie(e.data.description?e.data.description:""),W(e.data.public),te(e.data.ranked),ce(e.data.tags)})).catch((function(e){C(e),console.log(e),y(!1),m.Am.error(e.message,{position:m.Am.POSITION.BOTTOM_RIGHT,theme:"dark"})})).finally((function(){return A(100)}))}),[t]);return j?(0,Z.jsxs)(X,{className:"flex w-full justify-center items-center",children:[(0,Z.jsx)(g.Z,{color:x.Z.primary,progress:B,onLoaderFinished:function(){return A(0)}}),(0,Z.jsx)(P.a,{})]}):S?(0,Z.jsxs)("div",{children:["Une erreur est survenue : ",S.message]}):(0,Z.jsxs)(X,{children:[(0,Z.jsx)(g.Z,{color:x.Z.primary,progress:B,onLoaderFinished:function(){return A(0)}}),l?(0,Z.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,Z.jsxs)("div",{className:" text-start my-35 w-full",children:[(0,Z.jsxs)("label",{children:[e("list_name")," :"]}),(0,Z.jsx)(ee,{value:z,onChange:function(e){return L(e.target.value)},type:"text",placeholder:e("enter_list_name")})]}),(0,Z.jsxs)("div",{className:"flex flex-row flex-wrap sm:flex-nowrap  justify-between  gap-2 ",children:[(0,Z.jsx)("div",{className:"p-4 rounded-xl flex pb-4 h-fit sticky top-20  flex-col",style:{backgroundColor:x.Z.backgroundDerivation},children:(0,Z.jsxs)("div",{className:"flex flex-col gap-2  ",style:{minWidth:300,maxWidth:300},children:[(0,Z.jsx)("label",{children:e("add_game")})," ",(0,Z.jsx)(b,{listId:t,list:l,setList:f}),(0,Z.jsx)("label",{children:"Description"})," ",(0,Z.jsx)(k.ZP,{theme:{token:{colorBgContainer:"rgba(255, 255, 255, 0.9)",colorText:"black",fontWeightStrong:800,colorBorder:"transparent",colorPrimaryBorderHover:x.Z.primary,colorPrimaryHover:x.Z.primary,colorTextPlaceholder:"grey",fontFamily:"Inter"}},children:(0,Z.jsx)(Q,{value:oe,onChange:function(e){return ie(e.target.value)},showCount:!0,maxLength:300,placeholder:e("describe_your_list_in_some_words")+"...",autoSize:{minRows:3,maxRows:5},defaultValue:l.description})}),(0,Z.jsxs)(k.ZP,{theme:{token:{fontWeightStrong:800,colorText:"white",colorBgBase:x.Z.backgroundDerivation,colorBorder:"white",colorPrimary:x.Z.primary,colorTextPlaceholder:"grey",fontFamily:"Inter"}},children:[(0,Z.jsxs)("div",{className:"flex flex-col",children:[(0,Z.jsx)("label",{children:e("visibility")}),(0,Z.jsxs)(T.ZP.Group,{defaultValue:M?"public":"private",buttonStyle:"solid",onChange:function(e){W("public"===e.target.value)},children:[(0,Z.jsx)(T.ZP.Button,{style:{color:M?"black":"white"},value:"public",children:e("public")}),(0,Z.jsx)(T.ZP.Button,{style:{color:M?"white":"black"},value:"private",children:e("private")})]})]}),(0,Z.jsxs)("div",{className:"flex flex-col",children:[(0,Z.jsx)("label",{children:e("type")}),(0,Z.jsxs)(T.ZP.Group,{defaultValue:Y?"ranked":"classic",buttonStyle:"solid",onChange:function(e){te("ranked"===e.target.value);var t=(0,o.Z)({},l);t.ranked="ranked"===e.target.value,f(t)},children:[(0,Z.jsx)(T.ZP.Button,{style:{color:Y?"white":"black"},value:"classic",children:e("classic")}),(0,Z.jsx)(T.ZP.Button,{value:"ranked",style:{color:Y?"black":"white"},children:e("top")})]})]})]}),(0,Z.jsx)("label",{children:"Tags"})," ",(0,Z.jsx)($,{tags:le,setTags:ce}),(0,Z.jsxs)("button",{onClick:function(){A(10);var n=(0,o.Z)({},l);n.name=z,n.public=M,n.tags=le,n.description=oe,l.ranked?n.games=n.games.map((function(e,t){return(0,o.Z)((0,o.Z)({},e),{},{rank:t+1})})):n.games=n.games.map((function(e){e.rank;return(0,r.Z)(e,K)}));var i={method:"put",withCredentials:!0,url:"".concat("http://141-95-162-17.nip.io:8000","/api/lists/").concat(t),headers:{"Content-Type":"application/json"},data:n};(0,u.Z)(i).then((function(n){console.log(n),A(100),m.Am.success(e("list_updated_with_success"),{position:m.Am.POSITION.BOTTOM_RIGHT,theme:"dark"}),de("/list/".concat(t))})).catch((function(e){console.log(e),m.Am.error(e.message,{position:m.Am.POSITION.BOTTOM_RIGHT,theme:"dark"})})),A(100)},style:{color:x.Z.backgroundDerivation,fontWeight:700},className:" text-white p-2 mx-2 border-none hover:cursor-pointer bg-[#FDC500] hover:bg-[#FFD12E] btn-save-list",children:[e("save_list").toUpperCase()," "]})," ",(0,Z.jsxs)("div",{className:"flex flex-row w-full ",children:[(0,Z.jsx)(q.Z,{listId:t,navigate:de}),(0,Z.jsxs)(d.rU,{to:"/list/".concat(t),style:{color:"white",fontWeight:700,textAlign:"center"},className:" text-white p-2 mx-2 border-none hover:cursor-pointer flex-1 btn-view-list",children:[e("view_list").toUpperCase()," "]})," "]})]})}),(0,Z.jsx)("div",{className:"flex-1",children:(0,Z.jsx)(H,{list:l,setList:f,setProgress:A})})]})]}):(0,Z.jsx)(J.Z,{})]})}},2482:function(e,t,n){var r=n(2744),o=n(7192),i=n(1912),s=n(9230),a=n(9085),l=n(184),c=r.Z.confirm;t.Z=function(e){var t=e.listId,n=e.navigate,r=(0,s.$G)().t;return(0,l.jsxs)("button",{style:{color:"white",fontWeight:700},className:" text-white p-2 mx-2 border-none hover:cursor-pointer flex-1 btn-delete-list",onClick:function(){c({title:"".concat(r("are_you_sure_to_delete_this_list")," ?"),content:(0,l.jsxs)("p",{style:{fontFamily:"Inter"},children:[r("this_action_is")," ",(0,l.jsxs)("span",{style:{color:o.Z.danger,fontWeight:500},children:[" ",r("irreversible"),"."," "]})]}),okText:r("yes"),okType:"danger",okButtonProps:{style:{background:o.Z.danger,borderColor:o.Z.danger,color:"white"}},cancelText:r("no"),onOk:function(){i.Z.delete("".concat("http://141-95-162-17.nip.io:8000","/api/lists/").concat(t),{withCredentials:!0}).then((function(e){a.Am.success(r("list_deleted_with_success"),{position:a.Am.POSITION.BOTTOM_RIGHT,theme:"dark",autoClose:1500}),n("/lists")})).catch((function(e){console.log(e),a.Am.error(e.message,{position:a.Am.POSITION.BOTTOM_RIGHT,theme:"dark"})}))}})},type:"dashed",children:[r("delete").toUpperCase()," "]})}}}]);
//# sourceMappingURL=106.c9ea2ede.chunk.js.map